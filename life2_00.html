<!DOCTYPE HTML>
<!--
	Alpha by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Lost in Transcription - Life**2</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="assets/css/main.css" />
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
	</head>
	<body>
		<div id="page-wrapper">

			<!-- Header -->
				<header id="header">
					<h1><a href="index.html">Life<sup>2</sup> - Lost in Transcription</h1>
					<nav id="nav">
						<ul>
							<li><a href="index.html">Home</a></li>
							<li>
								<a href="#" class="icon fa-angle-down">More</a>
								<ul>
									<li><a href="life2_00.html">Blog</a></li>
									<li><a href="#">Publications</a></li>
									<li><a href="#">Curriculum Vitae</a></li>
									<li><a href="about_me.html">About Me</a></li>
									<li>
										<a href="#">Projects</a>
										<ul>
											<li><a href="https://github.com/djburks/WPCC">WPCC</a></li>
										</ul>
									</li>
								</ul>
							</li>
							<!--<li><a href="#" class="button">Sign Up</a></li>-->
						</ul>
					</nav>
				</header>

			<!-- Main -->
				<section id="main" class="container">
					<header>
						<h2>Life<sup>2</sup></h2>
						<p>Where I get to channel my inner Doug Funnie, and share cool stuff.</p>
					</header>
					<div class="box">
						<span class="image featured"><img src="images/life2_00.jpg" alt="" /></span>
						<h3>WPCC - A Weighted Pearson Correlation Module for Python</h3>
						<h4>June 12, 2016</h4>
						<p>I finally managed to snag a Sunday all to myself, and I couldn't think of a better way to spend that time than updating this project of a website with a Python module I wrote for calculating the weighted Pearson Correlation Coefficient (PCC) of two vectors.  You see, PCC is kind of a big deal in biology. Given the advent of big data, and the flood of transcriptomic data that is pouring out of labs all across the world, PCC is <strong>the</strong> standard for correlating gene expression data.  In the early 2000s, normalizing expression data and calculating the direct correlation of every gene was seen as sufficient.  Of course, weaknesses become apparent over time, and a variety of implementations now exist to address those weaknesses.  There's implementations such as <a href="https://labs.genetics.ucla.edu/horvath/CoexpressionNetwork/Rpackages/WGCNA/">WGCNA</a>, and of course, you can't talk about PCC and gene expression without mentioning <a href="http://coxpresdb.jp/help/mr.shtml">Mutual Rank</a>.<br><br>

PCC isn't without competition.  It has been argued that <a href="https://en.wikipedia.org/wiki/Spearman%27s_rank_correlation_coefficient">Spearman's Correlation</a> is more suited to the noise inherent to next-gen sequencing data, as it is more forgiving in regards to the unavoidable evils that are outliers.  Personally, I think it's a combination of outliers and sample redundancy that makes determining gene correlation through PCC the most difficult.  One way to address that problem is by using a weighted PCC (wPCC), a sentiment shared by two brilliant researchers way back in 2009 when they published their paper on the derivation of a "mutual rank" (MR) from PCC <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC2762411/">[NCBI Link]</a>.  Prior to determining a gene's MR, Obayashi and Kinoshita first calculated the sample redundancy of their entire dataset.  This redundancy was then used to formulate a weight, and samples with high redundancy were penalized during the PCC calculation.<br><br>

The theory isn't really all that hard to understand.  You have a series of expression values for a set of genes.  That series might be made up from expression data taken individually from thousands of experiments.  The odds of those thousands of experiments not having some internal bias are slim to none.  But what if you were to penalize the redundant expression sets?  Put another way, if you wanted to get the most bang for your PCC buck, you would ideally want to focus on the most diverse sets of expression data when compared to the entire dataset.  That is precisely what using a weighted PCC does.<br><br>

Unfortunately, there isn't really a weighted PCC function in any of the popular Python module repos.  <a href="http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.stats.pearsonr.html">SciPy</a> has a nice pearsonr calculator as part of its statistical function library, but no support for weights.  So, I wrote one and used it as an excuse to learn more about github.  You can read more about it <a href="https://github.com/djburks/WPCC">here</a>, and even give it a test drive.  Simply download the wpcc.py file, and place it in the same directory as your own program that intends to use the weighted PCC function.  Then, make sure to import the module and call it appropriately.  See the README for my github repo for more information, and even examples.  I hope this serves fellow biologists hoping to stay in the comforting embrace of their Python environments.  If you have questions or comments, make sure to contact me through any of the avenues linked at the bottom of this page.<br><br>

<a href="https://github.com/djburks/WPCC">[GitHub] WPCC - Weighted Pearson Correlation Coefficient Calculator for Python 3.4+</a><br><br>
Equation image courtesy of ATTED II <a href="http://atted.jp/">[Link]</a></p>
						<div class="row">
							<div class="6u 12u(mobilep)">
								<h3>Hungry for More?</h3>
								<p>Keep an eye out here for more links as I update this thing.</p>
							</div>
						</div>
					</div>
				</section>

			<!-- Footer -->
				<footer id="footer">
					<ul class="icons">
						<li><a href="https://twitter.com/djburks87" class="icon fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="https://www.facebook.com/david.burks.5680" class="icon fa-facebook"><span class="label">Facebook</span></a></li>
						<li><a href="https://github.com/djburks" class="icon fa-github"><span class="label">Github</span></a></li>
						<li><a href="https://www.linkedin.com/in/djburks" class="icon fa-linkedin"><span class="label">LinkedIn</span></a></li>
						<li><a href="https://plus.google.com/u/0/116035124233841597016/posts" class="icon fa-google-plus"><span class="label">Google+</span></a></li>
					</ul>
					<ul class="copyright">
						<li>&copy; David Burks. All rights reserved.</li><li>Design: <a href="http://html5up.net">Inspired by HTML5 UP</a></li>
					</ul>
				</footer>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/jquery.scrollgress.min.js"></script>
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="assets/js/main.js"></script>

	</body>
</html>
